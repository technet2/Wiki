<html !DOCTYPE html>

<head>
    <script type='text/javascript' src='https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.5.2.min.js'></script>
    <link rel='stylesheet' type='text/css' href='include/LayoutMisc.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle2.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/ReducedStyle3.css' xmlns='http://www.w3.org/1999/xhtml'>
    <link rel='stylesheet' type='text/css' href='include/DynamicStyle.css' xmlns='http://www.w3.org/1999/xhtml'>
</head>

<body style='margin:20px !important;'>

    <div id='theHeader'></div>

    <div id='theBreadcrumb'>
        <div class='breadcrumb-list'>
    <span class='breadcrumb-item'><a class='internal-link view-home' href='https://github.com/technet2/Wiki/tree/master/docs'>Wiki</a></span>

    <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
    <span class='breadcrumb-item'>
        <a href='/Wiki/PageIndex1.html'>TechNet Articles</a>
    </span>

    <span class='breadcrumb-item'>
        <span class='separator'><span style='display:none;'></span>&nbsp;&gt;&nbsp;</span>
        <span class='breadcrumb-item'>
            <a href='https://github.com/technet2/Wiki/tree/master/docs/13182.wpf-mvvm-data-in-a-nutshell.html' class='last'>WPF, MVVM &amp; Data (in a nutshell) - TechNet Articles - United States (English) - TechNet Wiki</a>
        </span>
    </span>
</div>

    </div>

    <div id='theOther'>
        <div class='content-fragment page-navigation no-wrapper' id='fragment-6614'>
    <div class='content-fragment-inner fiji-content-fragment-inner'>
        <div class='content-fragment-top fiji-content-fragment-top'><div class='r1 fiji-r1'></div><div class='r2 fiji-r2'></div><div class='r3 fiji-r3'></div><div class='r4 fiji-r4'></div></div><div class='content-fragment-content'>

            <div class='navigation-list-header'></div>
            <ul class='navigation-list'>

                <li class='navigation-item selected'>
                    <a class='internal-link view-wiki-page' href='#'>
                        <span></span>
                        Article
                    </a>
                </li>

                <li class='navigation-item'>
                    <a class='internal-link wiki-page-history' href='https://github.com/technet2/Wiki/commits/master/docs/13182.wpf-mvvm-data-in-a-nutshell.html'>
                        <span></span>
                        History
                    </a>
                </li>

            </ul>
            <div class='navigation-list-footer'></div>
        </div>
        <div class='content-fragment-footer'></div>
        <div class='content-fragment-bottom fiji-content-fragment-bottom'><div class='r1 fiji-r1'></div><div class='r2 fiji-r2'></div><div class='r3 fiji-r3'></div><div class='r4 fiji-r4'></div></div>
    </div>
</div>
    </div>

    <h1 class='post-name'>WPF, MVVM &amp; Data (in a nutshell) - TechNet Articles - United States (English) - TechNet Wiki</h1>
            
    <!-- AUTO ADDED ABOVE -->

    <div class="post-content user-defined-markup"><strong><em>This is an article to summarize the concepts of WPF data manipulation, within&nbsp;the MVVM pattern.<br />
<br />
<div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#The_Model">The Model</a></li><li class="hierarchy-item"><a href="#The_ViewModel">The ViewModel</a></li><li class="hierarchy-item"><a href="#The_Repository">The Repository</a></li><li class="hierarchy-item"><a href="#DataAdapters">DataAdapters</a></li><li class="hierarchy-item"><a href="#Entity_Framework">Entity Framework</a></li><li class="hierarchy-item"><a href="#Further_reading">Further reading</a></li></ul><div class="hierarchy-list-footer"> </div></div><br />
<hr />
<br />
</em></strong>
<h2><a name="The_Model"></a>The Model</h2>
<br />
The Model in MVVM is usually just the class (business object). A &quot;Person&quot; class has properties and methods relating only to that class. This class is not usually responsible for persisting to database or file. The database layer is not really anything to do with the actual MVVM pattern, it&#39;s just part of the plumbing, so to speak.<br />
<br />
<h2><a name="The_ViewModel"></a>The ViewModel</h2>
<p>The ViewModel uses the &quot;database layer&quot;&nbsp;to collect and present data (data of the object classes in Model).&nbsp;The returned data is held in public properties of the ViewModel, like (List&lt;Person&gt;) MyPersonel. A ListBox on your View can then bind to the ViewModel property, consume the data and two-way update it with no further code needed.</p>
<p>&nbsp;</p>
<h2><a name="The_Repository"></a>The Repository</h2>
<p>The ViewModel could [for example] request data from a <a href="http://msdn.microsoft.com/en-us/library/ff649690.aspx"><span style="color:#0000aa;">Repository</span></a> (eg, a class in separate the &quot;Repositories&quot; folder). Then once the data is updated, you can use the same repository to same changes.</p>
<p>If you want full control, you can request the data and rebuild objects yourself, by hand. With some databases you have no choice. Here are a bunch of examples of connecting to an SQLite database, building objects and collections, saving back etc. All the usual database things you&#39;d need for SQLite.</p>
<p><a href="http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/dd0c204d-090f-4ce7-883d-e3722eeb474a"><span style="color:#0000aa;">http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/dd0c204d-090f-4ce7-883d-e3722eeb474a</span></a></p>
<p>&nbsp;</p>
<h2><a name="DataAdapters"></a>DataAdapters</h2>
<p>An alternative to this method is to use <a href="http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldataadapter(v=vs.71).aspx"><span style="color:#0000aa;">SqlDataAdapter</span></a>s, which bridge the gap. You then <a href="http://code.msdn.microsoft.com/site/mydashboard?f%5B0%5D.Type=SearchText&amp;f%5B0%5D.Value=datatable&amp;x=0&amp;y=0"><span style="color:#0000aa;">load DataTable.DefaultView into your DataGrid</span></a>. Additions and changes are two-way bound back to the DataTable, and you use &quot;adapter.Update()&quot; to save the changes to the database.<br />
&nbsp;</p>
<h2><a name="Entity_Framework"></a>Entity Framework</h2>
<p>The MS recommended way is to use <a href="http://msdn.microsoft.com/en-us/library/cc716735.aspx"><strong><span style="color:#0000aa;">Entity Framework</span></strong></a>. I HIGHLY recommend this method, as it generates the database layer and exposes the database as objects. A Person table is exposed as a &quot;Persons&quot; collection that you can add and remove to, then update to save.<a href="http://msdn.microsoft.com/en-us/vstudio/dd776537.aspx"><span style="color:#0000aa;">Watch here</span></a>.</p>
<p>&nbsp;</p>
<h2><a name="Further_reading"></a>Further reading&nbsp;</h2>
<p>If you haven&#39;t found it yet, one of the best introductions to MVVM is <a href="http://msdn.microsoft.com/en-us/magazine/dd419663.aspx"><span style="color:#0000aa;">Josh Smith&#39;s MSDN mag article </span></a>(especially <a href="http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090102"><span style="color:#0000aa;">The Data Model and Repository</span></a>)<br />
&nbsp;<br />
<br />
</p>
<hr />
<p>Please feel free to correct this article, or add to it. <br />
It is one of the sources I&nbsp;give in answer to MSDN WPF Forum questions, regarding the subject.</p></div>
    
    

    <!-- AUTO ADDED BELOW -->

    <div id='theFooter'></div>

    <script type='text/javascript'>
    
        var headerContainer = jQuery('#theHeader');
        jQuery.ajax({
            url: 'include/GitHubPagesWikiHeader.html',
            success: function (data) {
                headerContainer.html(data);
            }
        });

        var footerContainer = jQuery('#theFooter');
        jQuery.ajax({
            url: 'include/GitHubPagesWikiFooter.html',
            success: function (data) {
                footerContainer.html(data);
            }
        });       

    </script>
</body>

</html>