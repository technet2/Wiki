---
layout: windowsazurestorage
title: Windows Azure Blob MD5 Overview
weight: 3
---

<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
		<div id="single-content" class="div-content">

			
				
<article id="post-51" class="post-51 post type-post status-publish format-standard hentry category-uncategorized tag-windows-azure-blobs tag-windows-azure-blobs-block tag-windows-azure-blobs-page">

	<header class="entry-header single">
		<h1 class="entry-title">Windows Azure Blob MD5 Overview</h1>		<div class="rating-wrap">
		<div id="star-rating-51" class="wds-ratings" data-rating="0" data-userrating="0" data-postid="51" data-container="body" data-toggle="tooltip" title="0 user(s) rated">
			<div class="wds-ratings-inner-wrap">
				<div>
					<div aria-label="Select 5 star, this article is 0 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="5"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span><span aria-hidden="true" class="star-5"><span>&#x2605;</span></span></div><div aria-label="Select 4 star, this article is 0 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="4"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span></div><div aria-label="Select 3 star, this article is 0 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="3"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span></div><div aria-label="Select 2 star, this article is 0 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="2"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span></div><div aria-label="Select 1 star, this article is 0 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="1"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span></div>
				</div>
			</div>
		</div>
		</div>		<div class="clear-both"></div>
		<div class="entry-meta">
			<img alt="avatar of windows-azure-storage" src="https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Windows+Azure+Storage&amp;size=extralarge&amp;version=00000000-0000-0000-0000-000000000000" class="avatar avatar-22 photo" height="22" width="22"/><span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="59e1aedafa2d4428b7004b2c2fac4adc" href="https://social.msdn.microsoft.com/profile/Windows+Azure+Storage">Windows Azure Storage</a></span></span><span class="posted-on posted-on-margin"><span class="screen-reader-text"></span><time class="entry-date published updated" datetime="2011-02-17T23:22:09+00:00">February 17, 2011</time></span><span class="comments-link"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span><a href="https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/#respond">0</a></span>				<span class="social-icons-wrap">
		<ul class="social-icons">
			<li><div class="fb-share-button" data-href="https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/" data-layout="button_count" data-size="large" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/&amp;src=sdkpreparse">Share</a></div></li>
			<div id="fb-root" style="display:none"></div>

			<li class="social-icon twitter"><a data-social="{&quot;type&quot;:&quot;twitter&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/&quot;, &quot;text&quot;: &quot;Windows Azure Blob MD5 Overview&quot;}" href="#" id="post_tweet_count">0</a></li>
			<li class="social-icon linkedin"><a data-social="{&quot;type&quot;:&quot;linkedin&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/&quot;, &quot;text&quot;: &quot;Windows Azure Blob MD5 Overview&quot;}" href="#" id="get_post_linkedin_count">0</a></li>
		</ul>
	</span><!-- .social-icons-wrap -->
	<script type="text/javascript">
		// Get social counts
		jQuery( window ).load(function () {
			jQuery.getScript('https://blogs.msdn.microsoft.com/windowsazurestorage/wp-content/themes/microsoft/js/social-counts.js?ver=02092017')
				.done(function(script,textStatus) {
					window.msdnsocial.ajax('https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/');
				});
		});
	</script>
		</div>
		<hr>
	</header><!-- .entry-header -->

	<div class="entry-content single">
		<h3>Overview</h3>
<p>Windows Azure Blob service provides mechanisms to ensure data integrity both at the application and transport layers. This post will detail these mechanisms from the service and client perspective. MD5 checking is optional on both <b>PUT</b> and <b>GET</b> operations; however it does provide a convenience facility to ensure data integrity across the network when using HTTP. Additionally since HTTPS provides transport layer security additional MD5 checking is not needed while connecting over HTTPS as it would be redundant. </p>
<p>To ensure data integrity the Windows Azure Blob service uses MD5 hashes of the data in a couple different manners. It is important to understand how these values are calculated, transmitted, stored, and eventually enforced in order to appropriately design your application to utilize them to provide data integrity. </p>
<p>Please note, the Windows Azure Blob service provides a durable storage medium, and uses its own integrity checking for stored data. The MD5's that are used when interacting with an application are provided for checking the integrity of the data when transferring that data between the application and service via HTTP. For more information regarding the durability of the storage system please refer to the <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2010/12/30/windows-azure-storage-architecture-overview.aspx">Windows Azure Storage Architecture Overview</a>.</p>
<p>The following table shows the Windows Azure Blob service REST APIs and the MD5 checks provided for them:<br/>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="97">
<p><b>REST API</b></p>
</td>
<td valign="top" width="114">
<p><b>Header</b></p>
</td>
<td valign="top" width="156">
<p><b>Value</b></p>
</td>
<td valign="top" width="96">
<p><b>Validated By</b></p>
</td>
<td valign="top" width="168">
<p><b>Notes</b></p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/dd179451.aspx">Put Blob</a></p>
</td>
<td valign="top" width="114">
<p><i>x-ms-blob-content-md5</i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of blobs bits</p>
</td>
<td valign="top" width="96">
<p>Server</p>
</td>
<td valign="top" width="168">
<p>Full Blob</p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/dd179451.aspx">Put Blob</a></p>
</td>
<td valign="top" width="114">
<p><i>Content-MD5</i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of blobs bits</p>
</td>
<td valign="top" width="96">
<p>Server</p>
</td>
<td valign="top" width="168">
<p>Full Blob,<i> </i>If<i> x-ms-blob-content-md5</i> is present <i>Content-md5 is ignored</i></p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/dd135726.aspx">Put Block</a></p>
</td>
<td valign="top" width="114">
<p><i>Content-MD5</i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of block bits</p>
</td>
<td valign="top" width="96">
<p>Server</p>
</td>
<td valign="top" width="168">
<p>Validated prior to storing the block</p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/ee691975.aspx">Put Page</a></p>
</td>
<td valign="top" width="114">
<p><i>Content-MD5</i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of page bits</p>
</td>
<td valign="top" width="96">
<p>Server</p>
</td>
<td valign="top" width="168">
<p>Validated prior to storing the page</p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/dd179467.aspx">Put Block List</a></p>
</td>
<td valign="top" width="114">
<p><i>x-ms-blob-content-md5</i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of blobs bits</p>
</td>
<td valign="top" width="96">
<p>Client on subsequent download</p>
</td>
<td valign="top" width="168">
<p>Stored as the Content-MD5 blob property to be downloaded with blob for client side checks</p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/ee691966.aspx">Set Blob Properties</a></p>
</td>
<td valign="top" width="114">
<p><i>x-ms-blob-content-md5</i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of blobs bits</p>
</td>
<td valign="top" width="96">
<p>Client on subsequent download</p>
</td>
<td valign="top" width="168">
<p>Sets the blob Content-MD5 property.</p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/dd179440.aspx">Get Blob</a></p>
</td>
<td valign="top" width="114">
<p><i>Content-MD5</i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of blobs bits</p>
</td>
<td valign="top" width="96">
<p>Client</p>
</td>
<td valign="top" width="168">
<p>Returns the Content-MD5 property if one was stored/set with the blob</p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/dd179440.aspx">Get Blob</a> (range)</p>
</td>
<td valign="top" width="114">
<p><i>Content-MD5 </i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of blobs range bits</p>
</td>
<td valign="top" width="96">
<p>Client</p>
</td>
<td valign="top" width="168">
<p>If client specifies <em>x-ms-range-get-content-md5: true the Content-MD5 header will be dynamically calculated over the range of bytes requested. This is restricted to &lt;= 4 MB range requests</em></p>
</td>
</tr>
<tr>
<td valign="top" width="97">
<p><a href="http://msdn.microsoft.com/en-us/library/dd179394.aspx">Get Blob Properties</a></p>
</td>
<td valign="top" width="114">
<p><i>Content-MD5 </i></p>
</td>
<td valign="top" width="156">
<p>MD5 value of blobs bits</p>
</td>
<td valign="top" width="96">
<p>Client</p>
</td>
<td valign="top" width="168">
<p>Returns the Content-MD5 property if one was stored/set with the blob</p>
</td>
</tr>
</tbody>
</table>
<p>Table 1 : REST API MD5 Compatibility</p>
<h4>Service Perspective</h4>
<p>From the Windows Azure Blob Storage service perspective the only MD5 values that are explicitly calculated and validated on each transaction are the transport layer (HTTP) MD5 values. MD5 checking is optional on both <b>PUT</b> and <b>GET</b> operations. Note, since HTTPS provides transport layer security when using HTTPS any additional MD5 checking would be redundant, so MD5 checking is not needed when using HTTPS. We will be discussing two separate MD5 values which will provide checks for at different layers:</p>
<ul>
<li><b>PUT with Content-MD5</b>: When a content MD5 header is specified, the storage service calculates an MD5 of the data sent and checks that with the Content-MD5 that was also sent. If the two hashes do not match, the operation will fail with error code 400 (Bad Request). These values are transmitted via the <i>Content-MD5</i> HTTP header. This validation is available for PutBlob, PutBlock and PutPage. Note, when uploading a block, page, or blob the service will return the <i>Content-MD5</i> HTTP header in the response populated with the MD5 it calculated for the data received.</li>
<li><b>PUT with x-ms-blob-content-md5</b>: The application can also set the Content-MD5 property that is stored with a blob. The application can pass this in with the header <i>x-ms-blob-content-md5</i>, and the value with this is stored as the Content-MD5 header to be returned on subsequent <b>GETs</b> for the blob. This can be set when using PutBlob, PutBlockList or SetBlobProperties for the blob. If a user provides this value on upload all subsequent <b>GET</b> operations will return this header with the client provided value. The <i>x-ms-blob-content-md5 </i>header is a header we introduced for scenarios where we wanted to specify the hash for the blob content when the http request content is not fully indicative of the actual blob data, such as in PutBlockList. In a PutBlockList, the <i>Content-MD5</i> header would provide transactional integrity for the message contents (the block list in the request body) , while the x<i>-ms-blob-content-md5 </i>header would set the service side blob property. To reiterate, if a x<i>-ms-blob-content-md5 </i>header is provided it will supersede the Content-MD5 header on a PutBlob operation, for a PutBlock or PutPage operation it is<a name="_GoBack"></a> ignored.</li>
<li><b>GET</b>: On a subsequent <b>GET</b> operation the service will optionally populate the <i>Content-MD5</i> HTTP header if a value was previously stored with the blob via a PutBlob, PutBlockList, or SetBlobProperties. For range <b>GETs</b> an optional <i>x-ms-range-get-content-md5</i> header can be added to the request. When this header is set to true and specified together with the Range header for a range <b>GET</b>, the service dynamically calculates an MD5 for the range and returns it in the <i>Content-MD5</i> header, as long as the range is less than or equal to 4 MB in size. If this header is specified without the Range header, the service returns status code 400 (Bad Request). If this header is set to true when the range exceeds 4 MB in size, the service returns status code 400 (Bad Request). </li>
</ul>
<h4>Client Perspective</h4>
<p>We have already discussed above how the Windows Azure Blob service can provide transport layer security via the <i>Content-MD5 </i>HTTP header or HTTPS. In addition to this the client can store and manually validate MD5 hashes on the blob data from the application layer. The Windows Azure Storage Client library provides this calculation functionality via the exposed object model and relevant abstractions such as BlobWriteStream. </p>
<h5>Storing Application layer MD5 when Uploading Blobs via the Storage Client Library</h5>
<p>When utilizing the CloudBlob Convenience layer methods in most cases the library will automatically calculate and transmit the application layer MD5 value. However, there is an exception to this behavior when a call to an upload method results in </p>
<ul>
<li>A single <b>PUT</b> operation to the Blob service, which will occur when source data is less than CloudBlobClient.SingleBlobUploadThresholdInBytes. </li>
<li>A parallel upload (length &gt; CloudBlobClient.SingleBlobUploadThresholdInBytes and CloudBlobClient.ParallelOperationThreadCount &gt; 1).</li>
</ul>
<p>In both of the above cases, an MD5 value is not passed in to be checked, so in this scenario if the client requires data integrity checking they need to make sure and use HTTPS. (HTTPS can be enabled when constructing a CloudStorageAccount via the constructor or by specifying HTTPS as part of the baseAddress when manually constructing a CloudBlobClient)</p>
<p>All other blob upload operations from the convenience layer in the SDK send MD5â€™s that are checked at the blob service.</p>
<p>In addition to the exposed object methods, you can also provide the <i>x-ms-blob-content-md5</i> header via the Protocol layer on a PutBlob or PutBlockList request.</p>
<p>The below table lists the convention functions used to upload blobs, and which ones support sending MD5 checks and when they are sent.</p>
<p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="91">
<p><b>Layer</b></p>
</td>
<td valign="top" width="196">
<p><b>Method</b></p>
</td>
<td valign="top" width="298">
<p><b>Notes</b></p>
</td>
</tr>
<tr>
<td valign="top" width="91">
<p>Convenience</p>
</td>
<td valign="top" width="196">
<p>CloudBlob.OpenWrite</p>
</td>
<td valign="top" width="298">
<p>MD5 is sent. Note, this function is not currently supported for PageBlob</p>
</td>
</tr>
<tr>
<td valign="top" width="91">
<p>Convenience</p>
</td>
<td valign="top" width="196">
<p>CloudBlob.UploadByteArray</p>
</td>
<td valign="top" width="298">
<p>MD5 is sent if:</p>
<ul>
<li>Length is &gt;= CloudBlobClient. SingleBlobUploadThresholdInBytes AND</li>
<li>CloudBlobClient. ParallelOperationThreadCount==1</li>
</ul>
</td>
</tr>
<tr>
<td valign="top" width="91">
<p>Convenience</p>
</td>
<td valign="top" width="196">
<p>CloudBlob.UploadFile</p>
</td>
<td valign="top" width="298">
<p>MD5 is sent if:</p>
<ul>
<li>Length is &gt;= CloudBlobClient. SingleBlobUploadThresholdInBytes AND </li>
<li>CloudBlobClient. ParallelOperationThreadCount==1</li>
</ul>
</td>
</tr>
<tr>
<td valign="top" width="91">
<p>Convenience</p>
</td>
<td valign="top" width="196">
<p>CloudBlob.UploadText</p>
</td>
<td valign="top" width="298">
<p>MD5 is sent if:</p>
<ul>
<li>Length is &gt;= CloudBlobClient. SingleBlobUploadThresholdInBytes AND </li>
<li>CloudBlobClient. ParallelOperationThreadCount==1</li>
</ul>
</td>
</tr>
<tr>
<td valign="top" width="91">
<p>Convenience</p>
</td>
<td valign="top" width="196">
<p>CloudBlob.UploadFromStream</p>
</td>
<td valign="top" width="298">
<p>MD5 is sent if:</p>
<ul>
<li>Length is &gt;= CloudBlobClient. SingleBlobUploadThresholdInBytes AND</li>
<li>CloudBlobClient. ParallelOperationThreadCount==1</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Table 2 : Blob upload methods MD5 compatibility</p>
<h5>Validating Application Layer MD5 when downloading Blobs via the Storage Client Library</h5>
<p>The CloudBlob Download methods do not provide application layer MD5 validation; as such it is up to the application to verify the Content-MD5 returned against the data returned by the service. If the application layer MD5 value was specified on upload the Windows Azure Storage Client Library will populate it in CloudBlob.Properties.ContentMD5 on any download (i.e. DownloadText, DownloadByteArray, DownloadToFile, DownloadToStream, and OpenRead).</p>
<p>The example below shows how a client can validate the blobs MD5 hash once all the data is retrieved. </p>
<p><b>Example</b></p>
<pre class="code"><span style="color: green">// Initialization
</span><span style="color: blue">string </span>blobName = <span style="color: #a31515">&quot;md5test&quot; </span>+ Guid.NewGuid().ToString();
<span style="color: blue">long </span>blobSize = 8 * 1024 * 1024;

StorageCredentialsAccountAndKey creds = 
        <span style="color: blue">new </span>StorageCredentialsAccountAndKey(AccountName, AccountKey);
CloudStorageAccount account = <span style="color: blue">new </span>CloudStorageAccount(creds, <span style="color: blue">false</span>);
CloudBlobClient bClient = account.CreateCloudBlobClient();

<span style="color: green">// Set CloudBlobClient.SingleBlobUploadThresholdInBytes, all blobs above this 
// length will be uploaded using blocks
</span>bClient.SingleBlobUploadThresholdInBytes = 4 * 1024 * 1024;

<span style="color: green">// Create Blob Container 

</span>CloudBlobContainer container = bClient.GetContainerReference(<span style="color: #a31515">&quot;md5blobcontainer&quot;</span>);
Console.WriteLine(<span style="color: #a31515">&quot;Validating the Container&quot;</span>);
container.CreateIfNotExist();

<span style="color: green">// Populate Blob Data
</span><span style="color: blue">byte</span>[] blobData = <span style="color: blue">new byte</span>[blobSize];
Random rand = <span style="color: blue">new </span>Random();
rand.NextBytes(blobData);
MemoryStream retStream = <span style="color: blue">new </span>MemoryStream(blobData);

<span style="color: green">// Upload Blob
</span>CloudBlob blobRef = container.GetBlobReference(blobName);

<span style="color: green">// Any upload method will work here: byte array, file, text, stream
</span>blobRef.UploadByteArray(blobData);

<span style="color: green">// Download will re-populate the client MD5 value from the server
</span><span style="color: blue">byte</span>[] retrievedBuffer = blobRef.DownloadByteArray();

<span style="color: green">// Validate MD5 Value
</span>var md5Check = System.Security.Cryptography.MD5.Create();
md5Check.TransformBlock(retrievedBuffer, 0, retrievedBuffer.Length, <span style="color: blue">null</span>, 0);     
md5Check.TransformFinalBlock(<span style="color: blue">new byte</span>[0], 0, 0);

<span style="color: green">// Get Hash Value
</span><span style="color: blue">byte</span>[] hashBytes = md5Check.Hash;
<span style="color: blue">string </span>hashVal = Convert.ToBase64String(hashBytes);

<span style="color: blue">if </span>(hashVal != blobRef.Properties.ContentMD5) 
{
     <span style="color: blue">throw new </span>InvalidDataException(<span style="color: #a31515">&quot;MD5 Mismatch, Data is corrupted!&quot;</span>);
}</pre>
<p><a href="http://11011.net/software/vspaste"></a></p>
<p>Figure 1: Validating a Blobs MD5 value</p>
<h5>A note about Page Blobs</h5>
<p>Page blobs are designed to provide a durable storage medium that can perform a high rate of IO. Data can be accessed in 512 byte pages allowing a high rate of non-contiguous transactions to complete efficiently. If HTTP needs to be used with MD5 checks, then the application should pass in the Content-MD5 on PutPage, and then use the <em>x-ms-range-get-content-md5 </em><em>on each subsequent GetBlob using ranges less than or equal to 4MBs.</em></p>
<p><b>Considerations</b></p>
<p>Currently the convenience layer of the Windows Azure Storage Client Library does not support passing in MD5 values for PageBlobs, nor returning Content-MD5 for getting PageBlob ranges. As such, if your scenario requires data integrity checking at the transport level it is recommended that you use HTTPS or utilize the Protocol Layer and add the additional Content-MD5 header.</p>
<p>In the following example we will show how to perform page blob range <b>GETs</b> with an optional <i>x-ms-range-get-content-md5</i> via the protocol layer in order to provide transport layer security over HTTP.</p>
<p><b>Example</b></p>
<pre class="code"><span style="color: green">// Initialization
</span><span style="color: blue">string </span>blobName = <span style="color: #a31515">&quot;md5test&quot; </span>+ Guid.NewGuid().ToString();
<span style="color: blue">long </span>blobSize = 8 * 1024 * 1024;

<span style="color: green">// Must be divisible by 512
</span><span style="color: blue">int </span>writeSize = 1 * 1024 * 1024;

StorageCredentialsAccountAndKey creds = 
    <span style="color: blue">new </span>StorageCredentialsAccountAndKey(AccountName, AccountKey);
CloudStorageAccount account = <span style="color: blue">new </span>CloudStorageAccount(creds, <span style="color: blue">false</span>);
CloudBlobClient bClient = account.CreateCloudBlobClient();
bClient.ParallelOperationThreadCount = 1;

<span style="color: green">// Create Blob Container 
</span>CloudBlobContainer container = bClient.GetContainerReference(<span style="color: #a31515">&quot;md5blobcontainer&quot;</span>);
Console.WriteLine(<span style="color: #a31515">&quot;Validating the Container&quot;</span>);
container.CreateIfNotExist();

<span style="color: blue">int </span>uploadedBytes = 0;
<span style="color: green">// Upload Blob
</span>CloudPageBlob blobRef = container.GetBlobReference(blobName).ToPageBlob;
blobRef.Create(blobSize);

<span style="color: green">// Populate Blob Data
</span><span style="color: blue">byte</span>[] blobData = <span style="color: blue">new byte</span>[writeSize];
Random rand = <span style="color: blue">new </span>Random();
rand.NextBytes(blobData);
MemoryStream retStream = <span style="color: blue">new </span>MemoryStream(blobData);

<span style="color: blue">while </span>(uploadedBytes &lt; blobSize)
{
    blobRef.WritePages(retStream, uploadedBytes);
    uploadedBytes += writeSize;
    retStream.Position = 0;
}

HttpWebRequest webRequest = BlobRequest.Get(
                                        blobRef.Uri,        <span style="color: green">// URI
                                        </span>90,                 <span style="color: green">// Timeout
                                        </span><span style="color: blue">null</span>,               <span style="color: green">// Snapshot (optional)
                                        </span>1024 * 1024,        <span style="color: green">// Start Offset
                                        </span>3 * 1024 * 1024,    <span style="color: green">// Count 
                                        </span><span style="color: blue">null</span>);              <span style="color: green">// Lease ID ( optional)

</span>webRequest.Headers.Add(<span style="color: #a31515">&quot;x-ms-range-get-content-md5&quot;</span>, <span style="color: #a31515">&quot;true&quot;</span>);
bClient.Credentials.SignRequest(webRequest);
WebResponse resp = webRequest.GetResponse();</pre>
<p><a href="http://11011.net/software/vspaste"></a></p>
<p>Figure 2: Transport Layer security via optional x-ms-range-get-content-md5 header on a PageBlob</p>
<h4>Summary</h4>
<p>This article has detailed various strategies when utilizing MD5 values to provide data integrity. As with many cases the correct solution is dependent on your specific scenario. </p>
<p>We will be evaluating this topic in future releases of the Windows Azure Storage Client Library as we continue to improve the functionality offered. Please leave comments below if you have questions.</p>
<p>Joe Giardino</p>
<h4>Links</h4>
<ul>
<li>Storage Client Library Documentation - <a href="http://msdn.microsoft.com/en-us/library/dd179380.aspx">http://msdn.microsoft.com/en-us/library/dd179380.aspx</a></li>
<li>Windows Azure SDK - <a href="http://msdn.microsoft.com/en-us/windowsazure/cc974146.aspx">http://msdn.microsoft.com/en-us/windowsazure/cc974146.aspx</a></li>
<li>Windows Azure Storage Services REST API Reference - <a href="http://msdn.microsoft.com/en-us/library/dd179355.aspx">http://msdn.microsoft.com/en-us/library/dd179355.aspx</a></li>
</ul>
	</div><!-- .entry-content -->


	<footer class="entry-footer single">
					<div class="tags">
				<span>Tags </span>
				<span>
					<a href="https://blogs.msdn.microsoft.com/windowsazurestorage/tag/windows-azure-blobs/" rel="tag">Windows Azure Blobs</a> <a href="https://blogs.msdn.microsoft.com/windowsazurestorage/tag/windows-azure-blobs-block/" rel="tag">Windows Azure Blobs - Block</a> <a href="https://blogs.msdn.microsoft.com/windowsazurestorage/tag/windows-azure-blobs-page/" rel="tag">Windows Azure Blobs - Page</a>				</span>
			</div>
				<hr>
	</footer><!-- .entry-footer -->

</article><!-- #post-## -->

			
		</div><!-- #single-content -->

		
<div id="comments" class="comments-area">
	<div class="comments-title">
		Comments (0)	</div>

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://blogs.msdn.microsoft.com/windowsazurestorage/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwindowsazurestorage%2F2011%2F02%2F17%2Fwindows-azure-blob-md5-overview%2F">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	
	
	
</div><!-- .comments-area -->
	</div><!-- #primary -->