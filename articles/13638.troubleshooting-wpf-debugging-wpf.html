---
layout: default
title: 'Troubleshooting WPF (Debugging WPF) - TechNet Articles - United States (English) - TechNet Wiki'
weight: 3
---

<div class="post-content user-defined-markup">

<strong><span style="font-size:8px;"></span>This article covers many techniques you can use to troubleshoot and debug your WPF application, including binding errors, exception handling, inspecting the VisualTree and&nbsp;logging.</strong>
<br />
&nbsp; <br />
<div style="text-align:justify;"><div class="table-of-contents"><h2 class="title">Table of Contents</h2><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Introduction">Introduction</a></li><li class="hierarchy-item"><a href="#Binding_Errors">Binding Errors</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Global_Trace_Level_in_Options">1. Changing Trace Level for All in Options</a></li><li class="hierarchy-item"><a href="#Trace_Level_on_a_Specific_Binding">2. Changing Trace Level on a Specific Binding</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#WPF_Tree_Visualizer">WPF Tree Visualizer</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Other_inspection_tools">Other inspection tools</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Debuging_Your_Code">Debuging Your Code</a></li><li class="hierarchy-item"><a href="#Inner_Exceptions">Inner Exceptions</a></li><li class="hierarchy-item"><a href="#Unhandled_Exceptions">Unhandled Exceptions</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Application_DispatcherUnhandledException">Application.DispatcherUnhandledException</a></li><li class="hierarchy-item"><a href="#AppDomain_CurrentDomain_UnhandledException">AppDomain.CurrentDomain.UnhandledException</a></li><li class="hierarchy-item"><a href="#Dispatcher_UnhandledException">TaskScheduler.UnobservedTaskException</a></li><li class="hierarchy-item"><a href="#The_catch-all_Unhandled_Handler">The catch-all Unhandled Handler!</a></li><li class="hierarchy-item"><a href="#Drilling_down_to_catch_the_Inner_Exception">Drilling down to include the Inner Exceptions</a></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#Commenting_Out_and_Binary_Chopping">Commenting Out and Binary Chopping</a></li><li class="hierarchy-item"><a href="#Is_It_Reproducable">Is It Reproducable?</a></li><li class="hierarchy-item"><a href="#Logging">Logging</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Logging_Level">Logging Level</a></li><li class="hierarchy-item"><a href="#Repository_Choice">Repository Choice</a></li><li class="hierarchy-item"><a href="#Why_Reinvent_the_Wheel">Why Reinvent the Wheel</a><div class="hierarchy-list-header"> </div><ul class="hierarchy-list"><li class="hierarchy-item"><a href="#Log4Net">Log4Net</a></li><li class="hierarchy-item"><a href="#ELMAH">ELMAH</a></li><li class="hierarchy-item"><a href="#NLog">NLog</a></li><li class="hierarchy-item"><a href="#NuGet">NuGet</a></li></ul><div class="hierarchy-list-footer"> </div></li></ul><div class="hierarchy-list-footer"> </div></li><li class="hierarchy-item"><a href="#See_Also">See Also</a></li><li class="hierarchy-item"><a href="#Community_Resources">Community Resources</a></li></ul><div class="hierarchy-list-footer"> </div></div><br />
</div>
<h1 style="text-align:justify;"><a name="Introduction"></a>Introduction</h1>
&nbsp; <br />
<div style="text-align:justify;">Windows Presentation Foundation (WPF) is a joy to&nbsp;develop rich user experiences&nbsp;with. Animations, bindings, reskinnable codeless interfaces, all backed up with traditional .Net programming&nbsp;all make for a very rapid development
 cycle. However, when something goes wrong in that autogenerated super-sexy front-end, it is not always clear where the problem is.<br />
</div>
&nbsp; <br />
<div style="text-align:justify;">This article will cover some of the methods&nbsp;for analyzing your WPF application, troubleshooting issues, and debugging seemingly obscure&nbsp;errors.&nbsp;&nbsp;<br />
</div>
&nbsp;<br />
<br />
<div style="text-align:justify;">↑ <a href="#Top">Return to Top</a> </div>
<hr style="text-align:justify;" />
<h1 style="text-align:justify;"><a name="Binding_Errors"></a>Binding Errors</h1>
&nbsp; <br />
<div style="text-align:justify;">When an error occurs in the binding framework, the notification is usually &quot;silent&quot;, in that is doesn&#39;t pop up an error dialog to the user. The error is instead&nbsp;displayed in the
<a href="http://msdn.microsoft.com/en-us/library/3hk6fby3.aspx">Output Window</a>&nbsp;of Visual Studio. Although the errors seem obscure at first, there are only a few common ones and they are&nbsp;quite helpful messages.<br />
</div>
&nbsp; <br />
<div style="text-align:justify;">Below are some typical errors and an explanation for each.<br />
</div>
&nbsp; <br />
<div style="text-align:justify;"><em><strong>System.Windows.Data Error: 4 : Cannot find source for binding with reference &#39;RelativeSource FindAncestor, AncestorType=&#39;<span style="color:#ff0000;">System.Windows.Controls.UserControl</span>&#39;, AncestorLevel=&#39;1&#39;&#39;.
 BindingExpression:Path=PartIds; DataItem=null; target element is &#39;ComboBox&#39; (Name=&#39;&#39;); target property is &#39;ItemsSource&#39; (type &#39;IEnumerable&#39;)</strong><br />
&nbsp; <br />
</em>This is a ComboBox inside a DataGridTemplateColumn. I am binding its ItemsSource to a property called PartIds.&nbsp;<br />
</div>
<div style="text-align:justify;">It is erroring when looking for the binding source, in other words&nbsp;the physical object to find the property on.
<br />
</div>
<div style="text-align:justify;">In this example, the error was because the source is a Window, not a UserControl.<br />
</div>
&nbsp; <br />
&nbsp; <br />
<em><strong>&quot;System.Windows.Data Error: 40 : BindingExpression path error: &#39;MyStringOptionz&#39; property not found on &#39;object&#39; &#39;&#39;MainWindow&#39; (Name=&#39;Window&#39;)&#39;. BindingExpression:Path=<span style="color:#ff0000;">MyStringOptionz</span>; DataItem=&#39;MainWindow&#39; (Name=&#39;Window&#39;);
 target element is &#39;ComboBox&#39; (Name=&#39;&#39;); target property is &#39;ItemsSource&#39; (type &#39;IEnumerable&#39;)&quot;</strong></em><br />
<br />
<div style="text-align:justify;">This is when the property name in the binding expression is wrong, or the property does not exist in the source object.
<br />
</div>
<div style="text-align:justify;">In this example, the property name was misspelled with a &#39;z&#39;.<br />
</div>
&nbsp; <br />
<div style="text-align:justify;">Sometimes you will&nbsp;need a more detailed debugging output for binding. There are two ways to do this.<br />
</div>
&nbsp;<br />
<h2 style="text-align:justify;"><a name="Global_Trace_Level_in_Options"></a><strong>1.&nbsp;Changing Trace Level for All in Options</strong></h2>
&nbsp;<br />
<div style="text-align:justify;">Click the&nbsp;Visual Studio menu&nbsp;<strong>Tools</strong> /
<strong>Options</strong>, then&nbsp;open <strong>Debugging</strong> and <strong>Output Window</strong>. In there you can change the
<strong>DataBinding output settings</strong> to <strong>Verbose</strong> or <strong>
All</strong>.<br />
</div>
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/7762.wpftv5_2D00_options.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/7762.wpftv5_2D00_options.png" style="border-width:0px;border-style:solid;" /></a><br />
<span style="font-size:9px;">(click to enlarge)</span><br />
&nbsp;<br />
<h2 style="text-align:justify;"><a name="Trace_Level_on_a_Specific_Binding"></a><strong>2.&nbsp;Changing Trace Level&nbsp;on a Specific Binding</strong></h2>
&nbsp;<br />
<div style="text-align:justify;">If you increase the trace level that way, you will get a WHOLE LOAD of messages for everything. Far better to target&nbsp;the specific binding where the error is. To do this, you can call on an Attached Property PresentationSources.TraceLevel
 and set it for just the one binding.<br />
</div>
<br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">ComboBox</code>
<code style="color:#808080;">ItemsSource</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;{Binding PartIdz,
<strong><span style="color:#ff0000;">PresentationTraceSources.TraceLevel=High</span></strong>, RelativeSource={RelativeSource AncestorType=Window}}&quot;</code>
<code style="color:#000000;">. . . /&gt;</code></span></div>
</div>
<br />
<div style="text-align:justify;">For more information on the Trace Levels and what they represent,
<a href="http://msdn.microsoft.com/en-us/library/dd409960.aspx">read here</a>.&nbsp;&nbsp;<br />
</div>
<br />
<div style="text-align:justify;">↑ <a href="#Top">Return to Top</a> </div>
<hr style="text-align:justify;" />
<h1 style="text-align:justify;"><a name="WPF_Tree_Visualizer"></a>WPF Tree Visualizer</h1>
<br />
<div style="text-align:justify;">The WPF Tree Visualizer comes <strong>built into Visual Studio</strong>, and is an<strong> essential tool</strong> to know about.<br />
</div>
<br />
<div style="text-align:justify;">With it, you can break into the Visual Tree and inspect the actual generated elements and their properties.<br />
</div>
<br />
<div style="text-align:justify;">To use a Visualizer, you click on the magnifying glass&nbsp;next to a variable name in
<span class="label">DataTips</span>, a <span class="label">Watch</span> window, or in the
<span class="label">Autos</span>, <span class="label">Locals</span>, or <span class="label">
Quick Watch</span> window.<br />
</div>
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/2538.wpftv1.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/2538.wpftv1.png" style="border:1px solid black;" /></a><br />
<br />
<div style="text-align:justify;">If you are visualizing a string object for example, you get&nbsp;a big grey&nbsp;text window. However, if you visualize a FrameworkElement, you get the WPF Tree Visualizer.<br />
</div>
<br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/4718.wpftv3.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/4718.wpftv3.png" style="border-width:0px;border-style:solid;" /></a><br />
<span style="font-size:10px;">(click to enlarge)<br />
</span>&nbsp; <br />
<strong>For a Quick Start on how to use the WPF TV, try this : </strong><a href="http://code.msdn.microsoft.com/Debugging-WPF-WPF-Tree-9849e429"><strong>Debugging WPF - WPF Tree Visualizer &#43; Helper Class</strong></a><br />
<div style="text-align:justify;">It also supplies a handy Attached Property you can drop in anywhere, without messing your code.&nbsp;&nbsp;<br />
</div>
&nbsp;<br />
<div style="text-align:justify;">The WPF Tree Visualizer is great for inspecting the VisualTree, but if you want to
<strong>change</strong> any of the properties, you have to look at the &quot;<strong>Locals</strong>&quot; tab, as shown below.<br />
</div>
&nbsp; <br />
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8345.wpftv4.png"><img alt=" " src="http://social.technet.microsoft.com/wiki/resized-image.ashx/__size/550x0/__key/communityserver-wikis-components-files/00-00-00-00-05/8345.wpftv4.png" style="border-width:0px;border-style:solid;" /></a><br />
<span style="font-size:10px;">(click to enlarge)<br />
</span>&nbsp;&nbsp; <br />
&nbsp;
<h2 style="text-align:justify;"><a name="Other_inspection_tools"></a><strong>Other inspection tools</strong></h2>
<br />
<div style="text-align:justify;">WPF Tree Visualizer is usually enough for the experienced developer to find the problem, however there are plenty of tools around&nbsp;if you prefer to&nbsp;defer.<br />
</div>
<ul>
<li><a href="http://wpfinspector.codeplex.com/">WPF Inspector</a> </li><li><a href="http://msdn.microsoft.com/en-us/library/ms727247.aspx"><span style="color:#0066dd;">UI Spy (in Microsoft Windows SDK)</span></a>
</li><li><a href="http://blois.us/Snoop/">Snoop</a> </li><li><a href="http://xamlt.com/">XamlIT</a> </li><li><a href="http://www.molosoft.com/">Mole</a> </li><li><a href="http://www.granthinkson.com/2007/11/08/announcing-pistachio-wpf-resource-visualizer/">Pistachio</a>
</li></ul>
<br />
<div style="text-align:justify;">↑ <a href="#Top"><span style="color:#0066dd;">Return to Top</span></a><span style="color:#0066dd;">
<hr />
</span></div>
<h1 style="text-align:justify;">Debuging Your Code<a name="Debuging_Your_Code"></a></h1>
<div style="text-align:justify;">Apart from the WPF Tree Visualiser, the debugger in WPF applications is the main way to break into your application, trace through&nbsp;and follow program execution to the point of failure.
<br />
</div>
<br />
<div style="text-align:justify;">This is all standard Visual Studio stuff, and I won&#39;t waste time here reproducing what is available elsewhere:<br />
</div>
<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/sc65sadd.aspx">Debugging in Visual Studio</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/awtaffxb(v=vs.100).aspx">Debugging Managed Code</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/7fe0dd2y(v=vs.100).aspx">Debugging, Tracing, and Profiling</a>
</li></ul>
<div style="text-align:justify;">↑ <a href="#Top"><span style="color:#0066dd;">Return to Top</span></a><span style="color:#0066dd;">
<hr />
</span></div>
<h1 style="text-align:justify;"><a name="Inner_Exceptions"></a>Inner Exceptions</h1>
<div style="text-align:justify;">When your application raises an exception, and you are debugging in Visual Studio, you get the usual error dialog with the details. However, when the error is a XAML error, it is most frequently buried deeper in the exception
 details. <br />
</div>
<br />
<div style="text-align:justify;">Within each exception is an Inner Exception, which is just another exception, but from a layer further down. If XAML throws an error about a missing resource, it re-raises the error as a meaningless &quot;XAML Markup error&quot;. When
 you drill down deeper, you find what resource the actual error relates to. <br />
</div>
<br />
<div style="text-align:justify;">Josh Smith wrote best documents&nbsp;the joy of inner exceptions&nbsp;<a href="http://joshsmithonwpf.wordpress.com/2007/03/29/tips-on-how-to-debug-and-learn-about-wpf/"><span style="color:#0066dd;">here</span></a>.&nbsp;<br />
</div>
<br />
<div style="text-align:justify;">↑ <a href="#Top">Return to Top</a> </div>
<hr style="text-align:justify;" />
<h1 style="text-align:justify;"><a name="Unhandled_Exceptions"></a>Unhandled Exceptions</h1>
<br />
<div style="text-align:justify;">It is impossible to protect against every possible fault that could&nbsp;happen, when your application is &quot;out in the wild&quot;.&nbsp;<br />
</div>
<br />
<div style="text-align:justify;">There are however, ways to try and improve on the standard Windows error dialogue, and stack dump, which will help you find the fault.<br />
</div>
&nbsp;<br />
<div style="text-align:justify;">When an exception is unhandled by your application, there are several Unhandled Exception events that you can tap into and handle.<br />
</div>
&nbsp; <br />
<strong>You can download and test all five handlers here : </strong><a href="http://code.msdn.microsoft.com/Handling-Unhandled-47492d0b"><strong>Handling Unhandled Exceptions in WPF (The most complete collection of handlers)</strong></a><br />
<br />
<img alt=" " src="http://code.msdn.microsoft.com/site/view/file/67146/1/exc.png" /> <br />
<h2 style="text-align:justify;"><a name="Application_DispatcherUnhandledException"></a><a href="http://msdn.microsoft.com/en-us/library/system.windows.application.dispatcherunhandledexception.aspx"><strong>Application.DispatcherUnhandledException</strong></a></h2>
<br />
<div style="text-align:justify;">This is triggered when the UI thread causes an unhandled exception. You can attach a handler&nbsp;to it either in App.xaml
<br />
</div>
<br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Application</code>
<code style="color:#808080;">x:Class</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;MyProject.App&quot;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">xmlns</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">xmlns:x</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</a>&quot;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">StartupUri</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;MainWindow.xaml&quot;</code>
<code style="color:#808080;">DispatcherUnhandledException</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;App_DispatcherUnhandledException&quot;</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Application.Resources</code>
<code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">&lt;/</code><code style="color:#006699;font-weight:bold;">Application</code><code style="color:#000000;">&gt;</code></span></div>
</div>
&nbsp;<br />
<div style="text-align:justify;">... or App.xaml.cs<br />
</div>
&nbsp;<br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">namespace</code>
<code style="color:#000000;">MyProject</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">partial</code> <code style="color:#006699;font-weight:bold;">
class</code> <code style="color:#000000;">App : Application</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">App()</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DispatcherUnhandledException &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
System.Windows.Threading.DispatcherUnhandledExceptionEventHandler(App_DispatcherUnhandledException);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
</div>
<br />
<div style="text-align:justify;">What you get in the handler arguments is a standard exception. Handle as you like, preferably write it to a permissions safe file location.<br />
</div>
<br />
<div style="text-align:justify;">You can also set<strong> e.Handled</strong> to true if you want to try to overcome the error and move on<br />
</div>
<br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">App_DispatcherUnhandledException(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, System.Windows.Threading.DispatcherUnhandledExceptionEventArgs e)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">ProcessError(e.Exception);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">e.Handled =
</code><code style="color:#006699;font-weight:bold;">true</code><code style="color:#000000;">;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
&nbsp; <br />
<div style="text-align:justify;">Sometimes the error is too severe, and your application still&nbsp;crashes. But at least you have hopefully captured something useful, before it did.<br />
</div>
&nbsp;<br />
<h2 style="text-align:justify;"><a name="AppDomain_CurrentDomain_UnhandledException"></a><a href="http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx"><strong>AppDomain.CurrentDomain.UnhandledException</strong></a></h2>
&nbsp;<br />
<div style="text-align:justify;">If the error is not on the UI thread, then the previous handler won&#39;t catch it. It is solely for the Dispatcher thread. To capture errors on any other thread, you need this second one.<br />
</div>
&nbsp;<br />
<div style="text-align:justify;">This handler is&nbsp;attached in the Startup event handler, which&nbsp;can again be hooked into from mark-up:<br />
</div>
&nbsp;<br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Application</code>
<code style="color:#808080;">x:Class</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;UnhandledExceptionHandler.App&quot;</code></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">xmlns</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>&quot;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">xmlns:x</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</a>&quot;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#808080;">StartupUri</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;MainWindow.xaml&quot;</code>
<code style="color:#808080;">Startup</code><code style="color:#000000;">=</code><code style="color:blue;">&quot;App_Startup&quot;</code><code style="color:#000000;">&gt;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">&lt;</code><code style="color:#006699;font-weight:bold;">Application.Resources</code>
<code style="color:#000000;">/&gt;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">&lt;/</code><code style="color:#006699;font-weight:bold;">Application</code><code style="color:#000000;">&gt;</code></span></div>
</div>
&nbsp;<br />
<div style="text-align:justify;">... or in code:<br />
</div>
<br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">namespace</code>
<code style="color:#000000;">MyProject</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">partial</code> <code style="color:#006699;font-weight:bold;">
class</code> <code style="color:#000000;">App : Application</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">App()</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Startup &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
StartupEventHandler(App_Startup);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">App_Startup(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, StartupEventArgs e)</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">AppDomain.CurrentDomain.UnhandledException &#43;= CurrentDomain_UnhandledException;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">CurrentDomain_UnhandledException(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, UnhandledExceptionEventArgs e)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var exception = e.ExceptionObject
</code><code style="color:#006699;font-weight:bold;">as</code> <code style="color:#000000;">
Exception;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">ProcessError(exception);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">if</code>
<code style="color:#000000;">(e.IsTerminating)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">MessageBox.Show(</code><code style="color:blue;">&quot;Goodbye world!&quot;</code><code style="color:#000000;">);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
</div>
<br />
&nbsp;<br />
<div style="text-align:justify;">Notice&nbsp;this uses an&nbsp;<strong>ExceptionObject</strong>, which&nbsp;is&nbsp;derived from Exception, so we can simply cast it back, for a generic exception handler, as&nbsp;shown below.<br />
</div>
&nbsp;<br />
<div style="text-align:justify;">Also notice the&nbsp;ExceptionObject has an <strong>IsTerminating</strong> flag.<br />
</div>
&nbsp;<br />
<h2 style="text-align:justify;"><a name="Dispatcher_UnhandledException"></a><a href="http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskscheduler.unobservedtaskexception.aspx"><strong>TaskScheduler.UnobservedTaskException</strong></a></h2>
<br />
<div style="text-align:justify;">This exception happens when a&nbsp;<a href="http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx"><strong>Task</strong></a> has an &quot;unobserved exception&quot;,&nbsp;and is about to trigger the &quot;exception escalation policy&quot;,
 which by default terminates the process.<br />
</div>
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">namespace</code>
<code style="color:#000000;">MyProject</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">partial</code> <code style="color:#006699;font-weight:bold;">
class</code> <code style="color:#000000;">App : Application</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">App()</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">TaskScheduler.UnobservedTaskException &#43;= TaskScheduler_UnobservedTaskException;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
</div>
<br />
&nbsp;<br />
<div style="text-align:justify;">Again, we can try to prevent crashing, in this case by&nbsp;calling the&nbsp;<strong>e.SetObserved</strong> method, which marks the exception as &quot;observed&quot; and prevents exception escalation towards a termination (crash).<br />
</div>
&nbsp; <br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">TaskScheduler_UnobservedTaskException(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, UnobservedTaskExceptionEventArgs e)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">ProcessError(e.Exception);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">e.SetObserved();</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
&nbsp;
<h2 style="text-align:justify;"><a name="The_catch-all_Unhandled_Handler"></a><strong>The catch-all Unhandled Handler!</strong></h2>
<br />
<div style="text-align:justify;">Putting those three handlers&nbsp;together, we get the following:<br />
</div>
<br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">namespace</code>
<code style="color:#000000;">MyProject</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#006699;font-weight:bold;">partial</code> <code style="color:#006699;font-weight:bold;">
class</code> <code style="color:#000000;">App : Application</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">public</code>
<code style="color:#000000;">App()</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">DispatcherUnhandledException &#43;= App_DispatcherUnhandledException;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">TaskScheduler.UnobservedTaskException &#43;= TaskScheduler_UnobservedTaskException;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">Startup &#43;=
</code><code style="color:#006699;font-weight:bold;">new</code> <code style="color:#000000;">
StartupEventHandler(App_Startup);</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#ffffff;"><span>&nbsp;</span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">void</code>
<code style="color:#000000;">App_Startup(</code><code style="color:#006699;font-weight:bold;">object</code>
<code style="color:#000000;">sender, StartupEventArgs e)</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">AppDomain.CurrentDomain.UnhandledException &#43;= CurrentDomain_UnhandledException;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
</div>
&nbsp;<br />
<div style="text-align:justify;">In the examples below, I show how to try&nbsp;and mark the exceptions as handled/observed, and continue execution. However,&nbsp;you may just want to close &quot;gracefully&quot;, with a polite message, instead of an all-out crash.<br />
</div>
&nbsp;<br />
<div style="text-align:justify;">One thing is certain, you will probably want a unified way of handling the exceptions, wherever they come from, as shown below.<br />
</div>
&nbsp;<br />
<h2 style="text-align:justify;"><a name="Drilling_down_to_catch_the_Inner_Exception"></a><strong>Drilling down to include the Inner Exceptions</strong></h2>
&nbsp;<br />
<div style="text-align:justify;">As mentioned before,&nbsp;the real reason for an error could be buried several layers down in Inner Exceptions. The three handlers above shared one error logging method, shown below, which iterates down till there&nbsp;are no more Inner
 Exceptions.<br />
</div>
&nbsp;<br />
<div class="reCodeBlock" style="text-align:justify;">
<div style="background-color:#ffffff;"><span><code style="color:#006699;font-weight:bold;">private</code>
<code style="color:#006699;font-weight:bold;">void</code> <code style="color:#000000;">
ProcessError(Exception exception)</code></span></div>
<div style="background-color:#f8f8f8;"><span><code style="color:#000000;">{</code></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">var error =
</code><code style="color:blue;">&quot;Exception = &quot;</code> <code style="color:#000000;">
&#43; exception.Message;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span>&nbsp;</span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#006699;font-weight:bold;">while</code><code style="color:#000000;">(exception.InnerException !=
</code><code style="color:#006699;font-weight:bold;">null</code><code style="color:#000000;">)</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">{</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">exception = exception.InnerException;</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">error &#43;=
</code><code style="color:blue;">&quot; : Inner Exception = &quot;</code> <code style="color:#000000;">
&#43; exception.Message;</code></span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">}</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><span>&nbsp;</span></span></div>
<div style="background-color:#ffffff;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#008200;">//This is where you save to file.</code></span></span></div>
<div style="background-color:#f8f8f8;"><span><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><span><code style="color:#000000;">MessageBox.Show(error);</code></span></span></div>
<div style="background-color:#ffffff;"><span><code style="color:#000000;">}</code></span></div>
</div>
&nbsp;<br />
<br />
<strong><span style="color:#ff0000;">Early attention to error handling in your application will always help production, because most bugs occur during development.<br />
<br />
See Logging below.</span></strong><br />
&nbsp;<br />
<br />
<div style="text-align:justify;">↑ <a href="#Top">Return to Top</a> </div>
<hr style="text-align:justify;" />
<h1 style="text-align:justify;"><a name="Commenting_Out_and_Binary_Chopping"></a>Commenting Out&nbsp;and Binary Chopping</h1>
<p style="text-align:justify;">&nbsp;<br />
If a bug in your application is being particularly hard to find, there may be only one way left to find the culprit. It&#39;s very simple, and is often simply the fastest way to drill down to the offender.<br />
<br />
The method is simply to remove (or comment out) sections of your code, or XAML, until you get execution&nbsp;PAST the error.
<br />
<br />
Then you start replacing parts of the removed code, until you find the exact control or method that is causing the problem.<br />
<br />
It is referred to as binary chopping because you cut the code into two, to get past the error, then in two again, replacing half of the removed code, and so on until you get down to the offending code/xaml.
<br />
<br />
You can comment out huge&nbsp;chunks of your code or markup in Visual Studio with ctrl-k &#43;&nbsp;c,&nbsp;then ctrl-k &#43; u to uncomment. Both functions also available in the edit / advanced&nbsp;menu.<br />
<br />
This is&nbsp;one of the&nbsp;advantages of writing your application to&nbsp;the MVVM design pattern. MVVM separates your UI (View) from the business logic supplied by the ViewModel, or the Model itself. This means the View is much more loosely coupled, and there are no hooks
 from code-behind, acting directly on controls, like&nbsp;referring to controls by name (x:Name) like MyTextBox.Text = &quot;hello&quot;. In MVVM the emphasis is all on the bindings, so commenting out half your XAML just means less binding requests, and commenting out half
 your code/properties means more binding errors, but not a crash.&nbsp;<br />
<br />
Even an MVVM setup can have problems when you try to&nbsp;comment out half the markup. Controls may be relying on other controls, with direct biding in XAML. So there is always a certain amount of&nbsp;&quot;knock-on&quot; effects that also need commenting out, but experience
 often shows it is quite simply a very fast and effective way to find the sinner.<br />
<br />
Just make sure you keep a copy of the original file (or have recently committed your code to source control) before such dramatic actions. Just in case you make an edit that looses your comment/cut history ;)<br />
&nbsp;<br />
&nbsp;<br />
↑ <a href="#Top">Return to Top</a></p>
<hr style="text-align:justify;" />
<h1 style="text-align:justify;"><a name="Is_It_Reproducable"></a>Is It Reproducable?</h1>
<p style="text-align:justify;">When you hit a brick wall, many people turn to the <a href="http://social.msdn.microsoft.com/Forums/en-US/wpf/threads">
MSDN forums</a>, for help and advice from other developers. Often, just the act of trying to put a problem into words for others to understand is equivalent to having a colleague look over your shoulder, which often catches those obvious &quot;too close to the trees&quot;
 kind of&nbsp;mistakes that we all make. <br />
<br />
However, if the problem isn&#39;t obvious from your description, you will get a much quicker and accurate response from the forum if you supply a
<strong>reproducable example of your problem</strong> in a few code snippets. <br />
<br />
<strong><em><span style="color:#ff0000;">Quite often, when you try to reproduce the problem in a new project, you will often find the culpret anyway!</span></em></strong>
</p>
&nbsp;<br />
&nbsp;<br />
<div style="text-align:justify;">↑ <a href="#Top">Return to Top</a> </div>
<hr style="text-align:justify;" />
<h1 style="text-align:justify;"><a name="Logging"></a>Logging</h1>
<p style="text-align:justify;">The other age old method of tracing bugs in your application, both in development and once released, is to keep a log of messages from every notable step of your application.<br />
&nbsp;<br />
If your bug is of a composite nature (comprising of several different causes), or developing after several iterations, or at an unknown point, you will need to build a picture of what is happening, before you can even know where to start.<br />
&nbsp;</p>
<h2 style="text-align:justify;"><a name="Logging_Level"></a><strong>Logging Level</strong></h2>
<p style="text-align:justify;">Writing comments and session data to a log file means scattering &quot;WriteToLog&quot; type methods throughout your code. It is therefore common to build a &quot;LogLevel&quot; parameter into your methods, allowing you to control the amount of spam
 that gets written. In a published application you would only want to capture critical messages, but with a config file flag or startup parameter that allows you to crank up the debug&nbsp;logging (logging&nbsp;ALL messages), for a client that experiences a bug.<br />
&nbsp; </p>
<h2 style="text-align:justify;"><a name="Repository_Choice"></a><strong>Repository Choice</strong></h2>
<p style="text-align:justify;">A log repository can be anything from a text file, to a database. One word of caution however. It is no good logging errors to a database if it was a database connection error. So file based logging for critical errors is strongly
 advised. Then you simply have a check method on application startup, for any waiting critical error files, that may have been generated when the application crashed. You can then &#39;process&#39; them (into a database, or send by email) and then delete.<br />
<br />
It is as explained, quite simple to create your own logging architecture for your application. The&nbsp;key to success&nbsp;is to START EARLY! Don&#39;t try to strap error handling or logging on later, as it will never be as useful as if you had started&nbsp;from the outset.
 Also, the majority of bugs are caused during development anyway, so early attention to error handling and logging may take slightly longer to code, but will help speed up the overall prodiuction process.<br />
&nbsp;</p>
<h2 style="text-align:justify;"><a name="Why_Reinvent_the_Wheel"></a><strong>Why Reinvent the Wheel</strong></h2>
<p style="text-align:justify;">You could have a lot of fun building your own error logging framework, that is thread safe and foolproof. Or if you&#39;re pushed for time or more interested in higher things, why not just adopt a tried and tested logging framework.
 Here are some options, but you should shop around, as new kids often come on the block.<br />
&nbsp;</p>
<h3 style="text-align:justify;"><a name="Log4Net"></a><a href="http://logging.apache.org/log4net/"><strong>Log4Net</strong></a></h3>
<p style="text-align:justify;"><strong>One of the&nbsp;most established frameworks.</strong><em><strong>&nbsp;</strong>&quot;log4net is a tool to help the programmer output log statements to a variety of output targets. In case of problems with an application, it is helpful
 to enable logging so that the problem can be located. With log4net it is possible to enable logging at runtime without modifying the application binary. The log4net package is designed so that log statements can remain in shipped code without incurring a high
 performance cost. It follows that the speed of logging (or rather not logging) is crucial. At the same time, log output can be so voluminous that it quickly becomes overwhelming. One of the distinctive features of log4net is the notion of hierarchical loggers.
 Using these loggers it is possible to selectively control which log statements are output at arbitrary granularity. log4net is designed with two distinct goals in mind: speed and flexibility&quot;</em><br />
&nbsp;<br />
&nbsp;</p>
<h3 style="text-align:justify;"><a name="ELMAH"></a><a href="http://code.google.com/p/elmah/"><strong>ELMAH</strong></a></h3>
<p style="text-align:justify;"><strong>A very popular&nbsp;framework.&nbsp;</strong>&quot;<em>Stands for Logging Modules and Handlers. An application-wide error logging facility that is completely pluggable. It can be dynamically added to a running ASP.NET web application,
 or even all ASP.NET web applications on a machine, without any need for re-compilation or re-deployment.&quot;</em></p>
<p style="text-align:justify;">&nbsp;</p>
<h3 style="text-align:justify;"><a name="NLog"></a><a href="http://nlog-project.org/"><strong>NLog</strong></a></h3>
<p style="text-align:justify;"><strong>Newer but 3rd popular </strong>&quot;<em>A logging platform for .NET with rich log routing and management capabilities. It can help you produce and manage high-quality logs for your application regardless of its size or complexity.&quot;<br />
<br />
</em></p>
<h3 style="text-align:justify;"><a name="NuGet"></a><a href="http://nuget.org/"><strong><span style="font-size:22px;">NuGet</span></strong></a></h3>
<p style="text-align:justify;">All of the above frameworks are available through NuGet. If you don&#39;t already have&nbsp;NuGet, it is like an App store for Visual Studio application development. If you want a logging framework, or an MVVM framework, simply open the
 package manager and search. Results are listed by popularity. Click to install, and the package gets downloaded and&nbsp;integrated into your current project. That means all the dlls are added and registered, and any supporting files are added to your project.
 It takes all the pain out of adding supporting packages to your project.&nbsp;<strong>This is a must for all developers. No excuses, get it naow!!</strong><br />
&nbsp;<br />
<br />
<br />
↑ <a href="#Top">Return to Top</a></p>
<hr style="text-align:justify;" />
<h1 style="text-align:justify;"><a name="See_Also"></a>See Also</h1>
<ul>
<li><a href="http://social.technet.microsoft.com/wiki/contents/articles/2200.wiki-troubleshooting-portal.aspx">Troubleshooting Portal</a>
</li><li>See routed events article <a href="http://code.msdn.microsoft.com/silverlight/WPFSilverlight-Routed-49a16914">
http://code.msdn.microsoft.com/silverlight/WPFSilverlight-Routed-49a16914</a> </li></ul>
<p style="text-align:justify;">&nbsp;↑ <a href="#Top">Return to Top</a></p>
<hr style="text-align:justify;" />
<h1 style="text-align:justify;"><a name="Community_Resources"></a>Community Resources</h1>
<ul>
<li><a href="http://code.msdn.microsoft.com/Debugging-WPF-WPF-Tree-9849e429">Debugging WPF - WPF Tree Visualizer &#43; Helper Class</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/dd409789.aspx">How to: Use the WPF Tree Visualizer</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/dd409960.aspx">How to: Display WPF Trace Information</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/ms753391.aspx">Trees in WPF</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/ktf38f66(v=vs.71).aspx">Breakpoints</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/a6td98xe(v=vs.71).aspx">Locals Window</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/w15yf86f(v=vs.71).aspx">Threads Window</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/3hk6fby3.aspx">Output Window</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/system.exception.innerexception.aspx">Exception<span>.</span>InnerException Property
</a></li><li><a href="http://msdn.microsoft.com/en-us/library/system.windows.application.dispatcherunhandledexception.aspx">Application<span>.</span>DispatcherUnhandledException Event</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx">AppDomain<span>.</span>UnhandledException Event</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.unhandledexception.aspx">Dispatcher<span>.</span>UnhandledException Event</a>
</li><li><a href="http://joshsmithonwpf.wordpress.com/2007/03/29/tips-on-how-to-debug-and-learn-about-wpf/"><span style="color:#0066dd;">Tips on how to debug and learn about WPF</span></a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/aa969767.aspx">WPF performance Suite (in Windows SDK)</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/ms727247.aspx">UI Spy (in Windows SDK)</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/dd460760(v=vs.100).aspx">Spy&#43;&#43;</a>
</li><li><a href="http://blog.wpfwonderland.com/2007/01/02/wpf-tools-stylesnooper/">StyleSnooper</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/aa970683.aspx">Optimizing WPF Application Performance</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/dd233107.aspx">Debugging Tools (.NET Framework)</a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/sc65sadd.aspx"><span style="color:#0066dd;">Debugging in Visual Studio</span></a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/awtaffxb(v=vs.100).aspx"><span style="color:#0066dd;">Debugging Managed Code</span></a>
</li><li><a href="http://msdn.microsoft.com/en-us/library/7fe0dd2y(v=vs.100).aspx"><span style="color:#0066dd;">Debugging, Tracing, and Profiling</span></a>
</li></ul>
<p style="text-align:justify;">&nbsp;</p>
<p style="text-align:justify;">↑ <a href="#Top">Return to Top</a></p>
<hr style="text-align:justify;" />
<a><img alt=" " src="http://c.statcounter.com/8310283/0/6971edff/1/" style="border:medium none;" /></a>

</div>
    
    
